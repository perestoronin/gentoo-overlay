diff --git a/source/CMakeLists.txt b/source/CMakeLists.txt
index d9f5955..2d9e71a 100644
--- a/source/CMakeLists.txt
+++ b/source/CMakeLists.txt
@@ -348,7 +348,6 @@ target_include_directories(${SPIRV_TOOLS}-shared
   PRIVATE ${spirv-tools_BINARY_DIR}
   PRIVATE ${SPIRV_HEADER_INCLUDE_DIR}
   )
-set_target_properties(${SPIRV_TOOLS}-shared PROPERTIES CXX_VISIBILITY_PRESET hidden)
 set_property(TARGET ${SPIRV_TOOLS}-shared PROPERTY FOLDER "SPIRV-Tools libraries")
 spvtools_check_symbol_exports(${SPIRV_TOOLS}-shared)
 target_compile_definitions(${SPIRV_TOOLS}-shared
diff --git a/source/opt/CMakeLists.txt b/source/opt/CMakeLists.txt
index b18610a9..6619bf1d 100644
@@ -250,8 +250,28 @@ target_link_libraries(SPIRV-Tools-opt
 set_property(TARGET SPIRV-Tools-opt PROPERTY FOLDER "SPIRV-Tools libraries")
 spvtools_check_symbol_exports(SPIRV-Tools-opt)
 
+add_library(SPIRV-Tools-opt-shared SHARED ${SPIRV_TOOLS_OPT_SOURCES})
+spvtools_default_compile_options(SPIRV-Tools-opt-shared)
+target_include_directories(SPIRV-Tools-opt-shared
+  PUBLIC
+    $<BUILD_INTERFACE:${spirv-tools_SOURCE_DIR}/include>
+    $<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}/include>
+  PUBLIC
+    $<BUILD_INTERFACE:${SPIRV_HEADER_INCLUDE_DIR}>
+    $<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}>
+  PRIVATE ${spirv-tools_BINARY_DIR}
+  )
+
+target_link_libraries(SPIRV-Tools-opt-shared
+  PUBLIC ${SPIRV_TOOLS}-shared)
+
+spvtools_check_symbol_exports(SPIRV-Tools-opt-shared)
+target_compile_definitions(SPIRV-Tools-opt-shared
+  PUBLIC SPIRV_TOOLS_SHAREDLIB
+)
+
 if(ENABLE_SPIRV_TOOLS_INSTALL)
-  install(TARGETS SPIRV-Tools-opt EXPORT SPIRV-Tools-optTargets
+  install(TARGETS SPIRV-Tools-opt SPIRV-Tools-opt-shared EXPORT SPIRV-Tools-optTargets
     RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
     LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
     ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR})
