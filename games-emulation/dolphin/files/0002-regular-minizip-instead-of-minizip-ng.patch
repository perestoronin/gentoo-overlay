From f545e1522d58b2fde85bb216506d658821273390 Mon Sep 17 00:00:00 2001
From: Roel Aaij <roel.aaij@gmail.com>
Date: Sat, 16 Jul 2022 11:39:27 +0200
Subject: [PATCH 2/3] regular minizip instead of minizip-ng

---
 CMakeLists.txt                                     | 2 +-
 Source/Core/Common/CMakeLists.txt                  | 2 +-
 Source/Core/Common/MinizipUtil.h                   | 3 ++-
 Source/Core/DiscIO/CMakeLists.txt                  | 2 +-
 Source/Core/DiscIO/VolumeVerifier.cpp              | 3 ++-
 Source/Core/UICommon/CMakeLists.txt                | 2 +-
 Source/Core/UICommon/ResourcePack/ResourcePack.cpp | 3 ++-
 7 files changed, 10 insertions(+), 7 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 1f22fb76cf..5f68f231ba 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -792,7 +792,7 @@ else()
   add_subdirectory(Externals/zlib)
 endif()
 
-pkg_check_modules(MINIZIP minizip-ng>=3.0.0)
+pkg_check_modules(MINIZIP minizip)
 if(MINIZIP_FOUND)
   message(STATUS "Using shared minizip")
   include_directories(${MINIZIP_INCLUDE_DIRS})
diff --git a/Source/Core/Common/CMakeLists.txt b/Source/Core/Common/CMakeLists.txt
index 86fd37a788..faf2e19266 100644
--- a/Source/Core/Common/CMakeLists.txt
+++ b/Source/Core/Common/CMakeLists.txt
@@ -142,7 +142,7 @@ PUBLIC
   enet
   fmt::fmt
   ${MBEDTLS_LIBRARIES}
-  minizip-ng
+  minizip
 
 PRIVATE
   ${CURL_LIBRARIES}
diff --git a/Source/Core/Common/MinizipUtil.h b/Source/Core/Common/MinizipUtil.h
index 6057632ddd..5f56053405 100644
--- a/Source/Core/Common/MinizipUtil.h
+++ b/Source/Core/Common/MinizipUtil.h
@@ -5,7 +5,8 @@
 
 #include <algorithm>
 
-#include <mz_compat.h>
+#include <minizip/zip.h>
+#include <minizip/unzip.h>
 
 #include "Common/CommonTypes.h"
 #include "Common/ScopeGuard.h"
diff --git a/Source/Core/DiscIO/CMakeLists.txt b/Source/Core/DiscIO/CMakeLists.txt
index ec1562325a..68028dbcfc 100644
--- a/Source/Core/DiscIO/CMakeLists.txt
+++ b/Source/Core/DiscIO/CMakeLists.txt
@@ -73,7 +73,7 @@ PUBLIC
 
 PRIVATE
   fmt::fmt
-  minizip-ng
+  minizip
   pugixml
   ZLIB::ZLIB
 )
diff --git a/Source/Core/DiscIO/VolumeVerifier.cpp b/Source/Core/DiscIO/VolumeVerifier.cpp
index fc1eddfb19..58f3913050 100644
--- a/Source/Core/DiscIO/VolumeVerifier.cpp
+++ b/Source/Core/DiscIO/VolumeVerifier.cpp
@@ -14,7 +14,8 @@
 
 #include <mbedtls/md5.h>
 #include <mbedtls/sha1.h>
-#include <mz_compat.h>
+#include <minizip/zip.h>
+#include <minizip/unzip.h>
 #include <pugixml.hpp>
 
 #include "Common/Align.h"
diff --git a/Source/Core/UICommon/CMakeLists.txt b/Source/Core/UICommon/CMakeLists.txt
index f2ffbd0821..2b7d5bd2a6 100644
--- a/Source/Core/UICommon/CMakeLists.txt
+++ b/Source/Core/UICommon/CMakeLists.txt
@@ -31,7 +31,7 @@ target_link_libraries(uicommon
 PUBLIC
   common
   cpp-optparse
-  minizip-ng
+  minizip
   pugixml
 
 PRIVATE
diff --git a/Source/Core/UICommon/ResourcePack/ResourcePack.cpp b/Source/Core/UICommon/ResourcePack/ResourcePack.cpp
index 585559029d..f2dc6d41e0 100644
--- a/Source/Core/UICommon/ResourcePack/ResourcePack.cpp
+++ b/Source/Core/UICommon/ResourcePack/ResourcePack.cpp
@@ -5,7 +5,8 @@
 
 #include <algorithm>
 
-#include <mz_compat.h>
+#include <minizip/zip.h>
+#include <minizip/unzip.h>
 
 #include "Common/CommonPaths.h"
 #include "Common/FileSearch.h"
-- 
2.35.1

